



## 进程&线程
#### 进程
- 常见的进程间通信方式
  - 管道/匿名管道(pipe)。只能用于父子或者兄弟进程之间；本质是一个内核缓冲区
  - 有名管道(FIFO)。本质是一个带路径的文件
  - 信号(Signal)
  - 信号量(semaphore)
  - 消息(Message)队列
  - 共享内存(share memory)
  - 套接字(socket)
  - [《进程间通信IPC》](https://www.jianshu.com/p/c1015f5ffa74)

- 最快的进程间通信方式是什么？
  - 共享内存

- 共享内存为什么比其他的进程间通信方式快？
  - 因为共享内存通过映射mmap的方式直接映射到进程的私有内存空间，进程可以直接对其进行读写
  - 其它方式的通信基本上都是需要借助内核来实现间接通信

- 重启进程后，原共享内存是否可以操作？对于普通的进程又是如何呢？
  - 进程重启共享内存中数据不会丢失，内核自举或调用shmdt或使用ipcrm删除后丢失

- 什么是孤儿进程和僵尸进程？
  - 孤儿进程：一个父进程退出，而它的一个或多个子进程还在运行，那么那些子进程将成为孤儿进程。孤儿进程将被init进程(进程号为1)所收养，并由init进程对它们完成状态收集工作，因此孤儿进程是没有危害的
  - 僵尸进程：一个进程使用fork创建子进程，如果子进程退出，而父进程并没有调用wait或waitpid获取子进程的状态信息，那么子进程的进程描述符仍然保存在系统中。这种进程称之为僵死进程
  - 解决办法：把产生大量僵死进程的那个元凶枪毙掉（也就是通过kill发送SIGTERM或者SIGKILL信号啦）。枪毙了元凶进程之后，它产生的僵死进程就变成了孤儿进 程，这些孤儿进程会被init进程接管，init进程会wait()这些孤儿进程，释放它们占用的系统进程表中的资源，
  - [《孤儿进程与僵尸进程[总结]》](https://www.cnblogs.com/anker/p/3271773.html)

- 什么是进程, 什么是线程。它们之间的区别和联系
  - 根本区别：进程是操作系统资源分配的基本单位，而线程是处理器任务调度和执行的基本单位
  - 资源开销：每个进程都有独立的代码和数据空间（程序上下文），程序之间的切换会有较大的开销；线程可以看做轻量级的进程，同一类线程共享代码和数据空间，每个线程都有自己独立的运行栈和程序计数器（PC），线程之间切换的开销小。
  - 包含关系：如果一个进程内有多个线程，则执行过程不是一条线的，而是多条线（线程）共同完成的；线程是进程的一部分，所以线程也被称为轻权进程或者轻量级进程。
  - 内存分配：同一进程的线程共享本进程的地址空间和资源，而进程之间的地址空间和资源是相互独立的
  - 影响关系：一个进程崩溃后，在保护模式下不会对其他进程产生影响，但是一个线程崩溃整个进程都死掉。所以多进程要比多线程健壮。
  - 执行过程：每个独立的进程有程序运行的入口、顺序执行序列和程序出口。但是线程不能独立执行，必须依存在应用程序中，由应用程序提供多个线程执行控制，两者均可并发执行
  - [《进程和线程的区别(超详细)》](https://blog.csdn.net/ThinkWon/article/details/102021274)
- 一个程序从开始运行到结束的完整过程
  - 编译
    - 预处理
    - 编译
    - 汇编
  - 目标文件的格式。Linux 下的目标文件格式叫做 ELF（Executable Linkable Format）
    ![](http://images-1251273400.cosgz.myqcloud.com/20201020231023.png)
  - 链接
    - 重定位表。编译器把所有需要被重定位的数据存放在重定位表中，这样链接器就能够知道该目标文件中哪些数据是需要被重定位的
    - 符号表（.symtab）。目标文件中的某些部分是需要在链接的时候被使用到的 “粘合剂”，这些部分我们可以把其称之为 “符号”，符号就保存在符号表中
  - 装载
    - 由于现代操作系统均采用分页的方式来管理内存，所以操作系统只需要读取可执行文件的文件头，之后建立起可执行文件到虚拟内存的映射关系，而不需要真正的将程序载入内存。一旦操作系统创建进程 (fork) 并载入了可执行文件 (exec)，那么虚拟内存的分布应该如下图所示
    ![](http://images-1251273400.cosgz.myqcloud.com/20201020231449.png)
  - 运行
    - 操作系统 jmp 到进程的第一条指令并不是 main 方法，而是别的代码。这些代码负责初始化 main 方法执行所需要的环境并调用 main 方法执行，运行这些代码的函数被称为入口函数或者入口点（Entry Point）
    - 操作系统在创建进程之后，jmp 到这个进程的入口函数
    - 入口函数对程序运行环境进行初始化，包括堆、I/O、线程、全局变量的构造，等等
    - 入口函数在完成初始化之后，调用 main 函数，开始执行程序的主体
    - main 函数执行完毕之后返回到入口函数，入口函数进行清理工作，最后通过系统调用结束进程
  - [《程序的编译、链接、装载与运行》](https://www.nosuchfield.com/2018/11/23/Program-compilation-linking-loading-and-running/)
  
- 怎么求一个进程可用栈空间的大小
- 进程A和进程B只能进行网络通信，当进程B挂掉之后进程A如何快速知道进程B挂掉？

- 调用fork，发生了些什么事情
- 一个进程里包含什么？
- 一个进程在32系统上寻址空间最多多大？
- 进程拥有的资源有那些？
- 父进程和子进程在内存上的关系？
- 多进程和多线程会有什么区别？可能出现什么问题
- 进程和线程的区别，开销大小有别的原因？所拥有的资源都是什么？线程的栈内存是怎么分配和排布的？

- 进程切换怎么实现 怎么保留断点信息。

- 进程的几个状态？进程状态转换
- 为什么用多线程而不用多进程
- - Linux 进程环境：僵尸进程、孤儿进程、守护进程、进程组、会话、前台进程组、后台进程组
- Linux 进程七大通信方式：signal、file、pipe、shm、sem、msg、socket
- 在main函数中定义了a和b两个int变量，调用sum函数求其和，说一下其压栈过程

- Linux共享库的概念和意义？

#### 线程
- 线程栈通常是多少
- 线程间通信
- 那一个线程可以访问另一个线程的线程栈吗，会发生什么
- 假设有两个线程，一个线程怎么了解到另外一个线程是否崩溃
- 线程同步与互斥哪些机制
- 线程安全队列该怎么实现，说了一下生产者消费者模型

- 多线程如何实现同步与互斥，针对一个问题具体讲一下怎么用
- 如何调整多线程的负载均衡？


- Linux 线程：互斥量、锁机制、条件变量、信号量、读写锁
- Linux 下并发模型：多进程、多线程、线程池
- 线程栈的大小，能调整吗？代码中怎么调整？

- fork，vfork，clone的关系，clone是为了创建线程的吗？

#### 协程

- 协程怎么切换，具体到寄存器


## 锁
- 互斥锁，自旋锁，读写锁，悲观锁/乐观锁
  - [《面试官：你说说互斥锁、自旋锁、读写锁、悲观锁、乐观锁的应用场景》](https://www.cnblogs.com/xiaolincoding/p/13675202.html)
  
- 什么时候会发生死锁

- 在代码实现上怎么解决死锁呢

- 有些线程处于死锁状态了，怎么在另一个线程中检测出来

- 互斥锁和读写锁有什么区别

- 自旋锁是什么，怎么实现的

- 如果不用锁怎么实现，说的自旋锁忙等待

- 自旋锁是怎么实现的

- 什么是死锁 怎样避免（超时锁 和 银行家算法） 简述银行家算法

- 解释生产者消费者模型

## 内存
- 内存分布与内存管理方式
- 虚拟内存与物理内存
- malloc分配的是虚拟内存还是物理内存？
- memset操作malloc的指针，是操作物理内存还是虚拟内存？
- 了解共享内存吗（说了下虚拟页面到物理页帧的映射），后问如果这两个进程都终止了，共享内存还在吗
- 操作系统内存分配与释放
- 内存4G，malloc申请4.1G会发生什么
- 一堆内存碎片。此时要分配一个大空间。可以分配吗（内存碎片加起来的空间大于要申请的空间）

- 内存分配算法（Linux下，包括页表等的详细信息）及缓存淘汰算法。

- 调用malloc时会立即分配物理内存吗？页表中一定会对应物理页框吗？swap交换空间





## 中断，信号，内核态，定时器，以及各种数据结构实现原理
- 什么是中断,中断处理流程,缺页中断

- 用户态和内核态 系统调用能不能进入内核态

- 定时器为什么要用最小堆；定时器除了小根堆，还可以怎么做

- 实现时间跨度为一天的定时器，插入时间复杂度O(1)，定时不需要很精确

- 信号实现原理

- 管道通信相关操作和实现？
- 未命名管道和命名管道的区别

- 解释一下内存池的概念
- 原子操作了解吗

- 缓冲区实现，为什么不使用循环队列

- 库函数和系统调用区别
- Linux写时复制技术

- 调度算法
- linux中CPU调度怎么做的
- Round-robin介绍一下

- 文件系统的inode，硬链接与软连接。


## 程序编译&链接

- 编译和链接了解吗？

- 静态链接库和动态链接库的区别

- 调用动态链接库时，加载到内存的哪一段

- 写一个没有main函数的代码，能够运行起来
  - _start，用nostartfiles编译



